version: '3.8'

services:
  ruoyi-gateway:
    image: ruoyi/${RUOYI_GATEWAY_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: gateway
    hostname: gateway
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_GATEWAY_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_GATEWAY_SERVICE_PORT}
    ports:
      - ${RUOYI_GATEWAY_SERVICE_PORT}:${RUOYI_GATEWAY_SERVICE_PORT}
    volumes:
      - ../services/gateway/logs:/home/app/logs
    environment:
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

  ruoyi-auth:
    image: ruoyi/${RUOYI_AUTH_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: auth
    hostname: auth
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile-Font
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_AUTH_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_AUTH_SERVICE_PORT}
    ports:
      - "20880:20880"
      - ${RUOYI_AUTH_SERVICE_PORT}:${RUOYI_AUTH_SERVICE_PORT}
    volumes:
      - ../services/auth/logs:/home/app/logs
    environment:
      DUBBO_DUBBO_IP_TO_REGISTRY: ${HOST_IP}
      DUBBO_DUBBO_PORT_TO_BIND: 20880
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

  ruoyi-system:
    image: ruoyi/${RUOYI_SYSTEM_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: system
    privileged: true
    hostname: system
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_SYSTEM_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_SYSTEM_SERVICE_PORT}
    ports:
      - "20881:20881"
      - ${RUOYI_SYSTEM_SERVICE_PORT}:${RUOYI_SYSTEM_SERVICE_PORT}
    volumes:
      - ../services/system/logs:/home/app/logs
    environment:
      DUBBO_DUBBO_IP_TO_REGISTRY: ${HOST_IP}
      DUBBO_DUBBO_PORT_TO_BIND: 20881
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

  ruoyi-gen:
    image: ruoyi/${RUOYI_GEN_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: gen
    hostname: gen
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_GEN_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_GEN_SERVICE_PORT}
    ports:
      - ${RUOYI_GEN_SERVICE_PORT}:${RUOYI_GEN_SERVICE_PORT}
    volumes:
      - ../services/gen/logs:/home/app/logs
    environment:
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

  ruoyi-job:
    image: ruoyi/${RUOYI_JOB_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: job
    hostname: job
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_JOB_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_JOB_SERVICE_PORT}
    ports:
      - ${RUOYI_JOB_SERVICE_PORT}:${RUOYI_JOB_SERVICE_PORT}
    volumes:
      - ../services/job/logs:/home/app/logs
    environment:
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

  ruoyi-resource:
    image: ruoyi/${RUOYI_RESOURCE_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: resource
    hostname: resource
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_RESOURCE_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_RESOURCE_SERVICE_PORT}
    ports:
      - "20882:20882"
      - ${RUOYI_RESOURCE_SERVICE_PORT}:${RUOYI_RESOURCE_SERVICE_PORT}
    volumes:
      - ../services/resource/logs:/home/app/logs
    environment:
      DUBBO_DUBBO_IP_TO_REGISTRY: ${HOST_IP}
      DUBBO_DUBBO_PORT_TO_BIND: 20882
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

  ruoyi-platform:
    image: ruoyi/${RUOYI_PLATFORM_SERVICE_NAME}:${RUOYI_VERSION}
    container_name: platform
    hostname: platform
    restart: always
    build:
      context: ../context
      dockerfile: development/Dockerfile
      args:
        - VERSION=${RUOYI_VERSION}
        - SERVICE_NAME=${RUOYI_PLATFORM_SERVICE_NAME}
        - SERVICE_PORT=${RUOYI_PLATFORM_SERVICE_PORT}
    ports:
      - "20884:20884"
      - ${RUOYI_PLATFORM_SERVICE_PORT}:${RUOYI_PLATFORM_SERVICE_PORT}
    volumes:
      - ../services/platform/logs:/home/app/logs
    environment:
      DUBBO_DUBBO_IP_TO_REGISTRY: ${HOST_IP}
      DUBBO_DUBBO_PORT_TO_BIND: 20884
      LANG: ${LANG}
      TZ: ${TZ}
    networks:
      - ruoyi_services_net
      - common_net

networks:
  ruoyi_services_net:
    external: true
    enable_ipv6: false
  common_net:
    external: true
    enable_ipv6: false

